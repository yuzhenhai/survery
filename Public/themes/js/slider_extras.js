if(typeof getElementById!="function"){var getElementById=function(b){if(typeof(b)=="object"){return b;}if(document.getElementById(b)){return document.getElementById(b);}else{throw new Error(b+' argument error, can not find "'+b+'" element');}};}function getElCoordinate(h){var j=h.offsetTop;var e=h.offsetLeft;var g=h.offsetWidth;var i=h.offsetHeight;while(h=h.offsetParent){j+=h.offsetTop;e+=h.offsetLeft;}return{top:j,left:e,width:g,height:i,bottom:j+i,right:e+g};}var neverModules=window.neverModules||{};neverModules.modules=neverModules.modules||{};neverModules.modules.slider=function(b){if((typeof b)!="object"){throw new Error("config argument is not a object, error raise from slider constructor");}this.sliderValue=b.sliderValue;this.targetId=b.targetId;this.hints=b.hints?b.hints:"";this.sliderCss=b.sliderCss?b.sliderCss:"";this.barCss=b.barCss?b.barCss:"";this.min=b.min?b.min:0;this.max=b.max?b.max:100;this.onstart=function(){};this.onchange=b.change||function(){};this.onend=function(){};this._defaultInitializer.apply(this);};neverModules.modules.slider.prototype={_defaultInitializer:function(){this._bar=null;this._slider=null;this._wrapper=null;this._target=getElementById(this.targetId);this._sliderPoint=null;if(this.min>this.max){var b=this.min;this.min=this.max;this.max=b;}this._value=this.min;},create:function(){this._createSlider();},dispose:function(){},createBar:function(_slider){with(this){var _self=this;_bar=document.createElement("DIV");_wrapper.appendChild(_bar);_bar.title=hints;_bar.id=targetId+"_bar";_bar.className=barCss;_bar.style.position="absolute";_bar.style.zIndex="3";_bar.onmousedown=function(evt){_self._initMoveSlider(evt);};_sliderPoint=document.createElement("span");_wrapper.appendChild(_sliderPoint);_sliderPoint.id=targetId+"_sp";_sliderPoint.style.color="red";_sliderPoint.style.fontSize="14px";_sliderPoint.style.width="24px";_sliderPoint.style.height="20px";_sliderPoint.style.textAlign="center";_sliderPoint.style.position="absolute";_sliderPoint.style.whiteSpace="nowrap";var isMatrix=targetId.indexOf("_")>-1;var is10=(this.max-this.min)%10==0;if(is10||(this.max-this.min)<=20){var ruler=document.createElement("div");ruler.id=targetId+"_ruler";ruler.className="ruler";var len=parseInt((this.max-this.min)/10);if(len<1){len=1;}var imax=10;if(!is10){imax=this.max-this.min;len=1;}var leftLen=100/imax;for(var i=0;i<=imax;i++){var node=document.createElement("div");node.className="cm";if(i==0){node.style.left="-4px";}else{if(i==imax){node.style.right="-5px";}else{node.style.left=i*leftLen+"%";}}if(i==imax){node.style.width="0";}node.setAttribute("data-value",this.min+i*len);ruler.appendChild(node);}ruler.onclick=function(evt){_slider.onclick();};var cwidth=_wrapper.clientWidth;if(_wrapper.clientWidth==0){cwidth=390;}var dwidth=cwidth-10;_slider.style.width=cwidth+"px";ruler.style.width=dwidth+"px";_wrapper.appendChild(ruler);}}},setValue:function(n,notfire){with(this){if(!_bar){return;}n=_Number(Number(n));n=n>max?max:n<min?min:n;_bar.style.left=Math.round((n-min)*((_slider.offsetWidth-_bar.offsetWidth)/(max-min)))+"px";_value=n;var sLeft=parseInt(this._bar.style.left);var marginLeft=18;if(this.max>=100){marginLeft=26;}var sWith=this._slider.offsetWidth-marginLeft;if(sLeft>sWith&&sWith>0){sLeft=sWith;}this._sliderPoint.style.left=sLeft+"px";this._sliderPoint.style.top=this._bar.offsetHeight-40+"px";this._sliderPoint.innerHTML=_value||"";if(!notfire){fireChange();fireEnd();}}},getValue:function(){return this._value;},fireStart:function(){this.onstart.call(this);},fireChange:function(){if(completeLoaded){this._bar.title=this._value;if(this.sliderValue.type){this.sliderValue.value=this._value;}else{this.sliderValue.style.display="none";}var a=parseInt(this._bar.style.left);var c=18;if(this.max>=100){c=26;}var b=this._slider.offsetWidth-c;if(a>b&&b>0){a=b;}this._sliderPoint.style.left=a-4+"px";this._sliderPoint.style.top=this._bar.offsetHeight-38+"px";this._sliderPoint.innerHTML=this._value;this._sliderPoint.zIndex="2";this._target.value=this._value;this.onchange.call(this._target);}},fireEnd:function(){this.onend.call(this);},_createSlider:function(){with(this){_wrapper=document.createElement("DIV");_target.appendChild(_wrapper);_wrapper.id=targetId+"_wrapper";_wrapper.style.position="relative";_slider=document.createElement("DIV");_wrapper.appendChild(_slider);_slider.id=targetId+"_slider";_slider.className=sliderCss;_slider.style.position="absolute";_slider.style.zIndex="2";createBar(_slider);var divClear=document.createElement("DIV");divClear.style.clear="both";_wrapper.appendChild(divClear);var _self=this;_slider.onclick=function(evt){_self._moveTo(evt);};}},_moveTo:function(evt){with(this){evt=evt?evt:window.event;var x=evt.clientX-getElCoordinate(_slider).left-Math.round(_bar.offsetWidth/2);x=_coordsX(x);_bar.style.left=x+"px";_value=Math.round(x/((_slider.offsetWidth-_bar.offsetWidth)/(max-min))+min);fireChange();fireEnd();}},_coordsX:function(x){with(this){x=_Number(x);x=x<=_slider.offsetLeft?_slider.offsetLeft:x>=_slider.offsetLeft+_slider.offsetWidth-_bar.offsetWidth?_slider.offsetLeft+_slider.offsetWidth-_bar.offsetWidth:x;return x;}},_coordsY:function(y){with(this){}},_Number:function(b){return isNaN(b)?0:b;},_initMoveSlider:function(evt){with(this){evt=evt?evt:window.event;var _self=this;_bar.slider_x=evt.clientX-_bar.offsetLeft;fireStart();document.onmousemove=function(evt){_self._changeHandle(evt);};document.onmouseup=function(evt){_self._endHandle(evt);};}},_changeHandle:function(evt){with(this){evt=evt?evt:window.event;var x=evt.clientX-_bar.slider_x;x=_coordsX(x);_value=Math.round(x/((_slider.offsetWidth-_bar.offsetWidth)/(max-min))+min);_bar.style.left=x+"px";fireChange();}},_endHandle:function(evt){with(this){document.onmousemove=null;document.onmouseup=null;fireEnd();}}};